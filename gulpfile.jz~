//  Require
//
var gulp        = require('gulp'),
    autoprefix  = require('gulp-autoprefixer'),
    del         = require('del'),
    inline      = require('gulp-inline-source'),
    minify      = require('gulp-minify-html'),
    sass        = require('gulp-sass'),
    sync        = require('browser-sync'),
    reload      = sync.reload;

//  Paths
//
var html__src    = 'app/*.html',
    html__build  = 'build',
    sass__src    = 'app/sass/**/*.scss',
    sass__build  = 'app/css',
    server__path = 'build';

//  Styles
//
gulp.task('sass', function() {
    gulp.src(sass__src)
        .pipe(sass())
        .pipe(autoprefix())
        .pipe(gulp.dest(sass__build))
        .pipe(reload({ stream: true }));
});

//  Inline
//
gulp.task('inline', ['sass'], function () {
    gulp.src(html__src)
        .pipe(inline())
        .pipe(minify())
        .pipe(gulp.dest(html__build))
        .pipe(reload({ stream: true }));
});

//  Serve
//
gulp.task('serve', ['inline'], function() {
    sync.init({
        server: server__path
    });
    gulp.watch(html__src, ['inline']);
    gulp.watch(sass__src, ['inline']);
});

//  Default
//
gulp.task('default', ['serve']);
